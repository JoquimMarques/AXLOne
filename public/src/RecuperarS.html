<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../fontawesome-free-6.5.2-web/css/all.min.css">
    <link rel="apple-touch-icon" href="../favicon_io-13/apple-touch-icon.png">
    <link rel="shortcut icon" href="../favicon_io-13/apple-touch-icon.png" type="image/png">
    
    <title>AXLOne/Recuperar</title>

    <style>




    /* Reset básico */
    * {
     margin: 0;
     padding: 0;
     box-sizing: border-box;
     font-family: Arial, sans-serif;
   
 }
 
 html, body {
     background-color: rgb(0, 0, 0);
     width: 100%;
     height: 100%;
     margin: 0;
     padding: 0;
     position: fixed;
     overflow-x: hidden;
    color: white;
    font-family: Verdana, Geneva, Tahoma, sans-serif;
 }
 
 
 #notification-banner {
    
    position: fixed;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 20px 30px;
    border-radius: 5px;
    font-size: 16px;
    color: white;
    text-align: center;

    z-index: 1000;
}

.success {
    background-color: #0ebd1c; /* Verde */
    padding: 30px;
    margin-top: 490px;
}

.error {
    background-color: #f44336; /* Vermelho */
    padding: 30px;
    margin-top: 490px;
}

.hidden {
    display: none;
}


.login, .luzes-ligada, .luzes-apagada{
    border: none;
    background-color: transparent;
   
   

}
.luzes-apagada i{
    background-color: rgb(0, 0, 0);
    border:none;
    padding:20px 23px;
    border-radius: 100px;
    color:white;
    font-size: 20px;
    
    position: absolute; /* Garante que ele fique fixo */
    right: 10px; /* Alinha na esquerda */
    margin: 0; /* Remove margens */
    top: 10px;

   

} .luzes-ligada i {
    background-color: rgb(255, 255, 255);
    border:none;
    padding: 20px;
    border-radius: 100px;
    color:rgb(0, 0, 0);
    font-size: 20px;

    position: absolute; /* Garante que ele fique fixo */
    right: 10px; /* Alinha na esquerda */
    margin: 0; /* Remove margens */
    top: 10px;



}
.login i {
 
    border:none;
    padding: 20px 20px;
    border-radius: 100px;
    color:white;
    font-size: 20px;
    position: absolute; /* Garante que ele fique fixo */
    right: 340px; /* Alinha na esquerda */
    margin: 0; /* Remove margens */
    top: 10px;

}



 .logo {
    position: absolute; /* Garante que ele fique fixo */
    left: 756px; /* Alinha na esquerda */
    margin: 0; /* Remove margens */
    top: -70px;
    width: 400px;
  

}

.ImgLo{
    width: 600px;
    position: absolute; /* Garante que ele fique fixo */
    left: 70px; /* Alinha na esquerda */
    margin: 0; /* Remove margens */
    top: 30px;
   
    
}


.container2{
   
    box-shadow: 0 0 20px #e0b20e64;
    /* border:1px solid #e0b20e; */
    padding: 300px 30px 20px ;
    border-radius: 10px;
    width: 120%;
    max-width: 400px;
    text-align: center;
    position: absolute;
    top: 45%;
    left: 70%;
    transform: translate(-50%, -50%);

}


/* Estilização dos inputs com ícones */
.input-container {
    position: relative;
    margin-bottom: 30px;
}

.input-container input {
    width: 100%;
    padding: 10px 30px; /* Espaço para os ícones */
    border: 2px solid #e0b20e;
    background-color: transparent;
    border-radius: 40px;
    font-size: 16px;
    transition: all 0.3s ease;
    color:white;
}

/* Ícones dentro dos inputs */
.input-container i {
    position: absolute;
    left: 15px;
    top: 23%;
    transform: translateY(1px);
    color: #aaa;
    font-size: 18px;
    transition: all 0.7s ease;
}

/* Quando o input está focado, o ícone sobe */
.input-container input:focus + i {
    transform: translateY(-10%);
    color: rgb(0, 0, 0);
}

/* Ícone do olho na senha */
.input-container .eye-icon {
    right: 10px;
    left: auto;
    cursor: pointer;
    transition: transform 0.7s ease;
}

/* Quando a senha está focada, o olho muda */
.input-container input:focus + .eye-icon {
    transform: scale(1.2);
}

/* Botão de login */

.bthE{

width: 70%;
background: #e0b20e;
color: white;
border: none;
padding: 12px;
border-radius: 50px;
font-size: 16px;
cursor: pointer;
margin-left: -3px;
margin-top: 14px;
animation: bri 7s infinite;
border: 2px solid #e0b20e;

}

/* @keyframes brilho {
    0% {
        box-shadow: 0 0 0 #e0b20e;
        
    }
    50% {
        box-shadow: 0 0 5px #e0b20e, 0 0 10px #e0b20e, 0 0 10px #e0b20e;
   
        
    }
    100% {
        box-shadow: 0 0 2px #e0b20e, 0 0 5px #e0b20e, 0 0 0px #e0b20e;
      
    }
} */



@keyframes bri {
0% {
  
    transform: scale(1);
}
50% {
    border: 2px solid rgb(255, 255, 255);
    transform: scale(1.1);
    
}
100% {
   
    transform: scale(1);
}
}



/* Links de recuperação e criação de conta */
.links {
    margin-top: 30px;
    display: flex;
    gap:100px;
    justify-content: center;
    font-size: 14px;
}

.links a {
    color: #ffffff;
    text-decoration: none;
}

.links a:hover {
    text-decoration: underline;
}
.cad{
    text-transform: uppercase;
    font-size:28px;
    margin-bottom: 35px;
    margin-top: -140px;
    font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
    
}






 @media (min-width: 320px) and (max-width:768px){

    .hidde{
        display: none;
    }
    

    /* Reset básico */
 * {
     margin: 0;
     padding: 0;
     box-sizing: border-box;
     font-family: Arial, sans-serif;
   
 }
 
 html, body {
     background-color: black;
     width: 100%;
     height: 100%;
     margin: 0;
     padding: 0;
     position: fixed;
     overflow-x: hidden;
    color: white;
    font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
 }


#notification-banner {
    position: fixed;
    top: 160px;
    left: 50%;
    transform: translateX(-50%);
    padding: 30px 40px;
    border-radius: 5px;
    font-weight: bold;
    font-size: 16px;
    color: white;
    text-align: center;
    /* animation: bril 7s infinite; */
    z-index: 1000;
    border-radius: 15px;
}

.success {
    background-color: #0ebd1c; /* Verde */
    border:2px solid rgb(6, 77, 0);
    padding: 70px;
 
    margin-top: -33px;
    margin-left:-2px;
    margin-right: -60px;
   
}

.error {
    background-color: #f44336; /* Vermelho */
    padding: 70px;
    border:2px solid rgb(77, 0, 0);
   
    
    margin-top: -40px;
    margin-left:-2px;
    margin-right: -60px;
   
}

.hidden {
    display: none;
}

@keyframes bril {
    0% {
        box-shadow: 0 0 0 #e0b20e;
        border:2px solid white;
        transform: scale(1);
    }
    50% {
        box-shadow: 0 0 5px #e0b20e, 0 0 10px #e0b20e, 0 0 10px #e0b20e;
        transform: scale(1.1);
        
    }
    100% {
        box-shadow: 0 0 2px #e0b20e, 0 0 5px #e0b20e, 0 0 0px #e0b20e;
        transform: scale(1);
    }
}


 
 
 /* HEADER */
 .header {
     color: white;
     padding: 15px 20px;
     margin-bottom: -90px ;
 }
 
 .header_nav h1 {
     font-size: 250px;
     margin-left: -10px;
 }
 
 .header_nav{
     display: flex;
     justify-content: center;
     gap:20px;
     
 }
 

 .login i{
     background: none;
     border: none;
     color: white;
     font-size: 20px;
     background-color: #e0b20e;
     padding: 20px 22px;
     border:none;
     border-radius: 100%;
     font-size: 20px;
    position: absolute; /* Garante que ele fique fixo */
    right: 340px; /* Alinha na esquerda */
    margin: 0; /* Remove margens */
    top: 20px;
     
 
 }
 
 .login, .luzes-ligada, .luzes-apagada{
     border: none;
     background-color: transparent;
     
    
    
 
 }
 .luzes-apagada i{
     background-color: rgb(0, 0, 0);
     border:none;
     padding: 20px 22px;
     border-radius: 100px;
     margin-top: 10px;
     color:white;
     font-size: 22px;
 
 } .luzes-ligada i {
     background-color: rgb(255, 255, 255);
     border:none;
     padding: 20px 21px;
     margin-top: 10px;
     border-radius: 100px;
     color:rgb(0, 0, 0);
     font-size: 22px;
 
 }


 .logo {
    
    position: absolute; /* Garante que ele fique fixo */
    left: 10px; /* Alinha na esquerda */
    margin: 0; /* Remove margens */
    top: -65px;
    width: 250px;

  
}

.cad{
    text-transform: uppercase;
    font-size:28px;
    margin-bottom: 35px;
    margin-top: -160px;
    font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
}

/* Centraliza o formulário na tela */

.container2{
    padding: 20px;
    border-radius: 10px;
    width: 120%;
    max-width: 400px;
    text-align: center;
    position: absolute;
    top: 67%;
    left: 50%;
    transform: translate(-50%, -50%);
    box-shadow: none;
}

/* Estilização dos inputs com ícones */
.input-container {
    position: relative;
    margin-bottom: 30px;
}

.input-container input {
    width: 100%;
    padding: 10px 30px; /* Espaço para os ícones */
    border: 2px solid #e0b20e;
    background-color: transparent;
    border-radius: 40px;
    font-size: 16px;
    transition: all 0.3s ease;
    color:white;
}

/* Ícones dentro dos inputs */
.input-container i {
    position: absolute;
    left: 10px;
    top: 23%;
    transform: translateY(1px);
    color: #aaa;
    font-size: 18px;
    transition: all 0.7s ease;
}

/* Quando o input está focado, o ícone sobe */
.input-container input:focus + i {
    transform: translateY(-10%);
    color: rgb(0, 0, 0);
}

/* Ícone do olho na senha */
.input-container .eye-icon {
    right: 10px;
    left: auto;
    cursor: pointer;
    transition: transform 0.7s ease;
}

/* Quando a senha está focada, o olho muda */
.input-container input:focus + .eye-icon {
    transform: scale(1.2);
}


.bthE{

    width: 70%;
    background: #e0b20e;
    color: white;
    border: none;
    padding: 12px;
    border-radius: 50px;
    font-size: 16px;
    cursor: pointer;
    margin-left: -3px;
    margin-top: 14px;
    animation: brilho 7s infinite;
    
}

@keyframes brilho {
    0% {
        box-shadow: 0 0 0 #e0b20e;
        transform: scale(1);
    }
    50% {
        box-shadow: 0 0 5px #e0b20e, 0 0 10px #e0b20e, 0 0 10px #e0b20e;
        transform: scale(1.1);
        
    }
    100% {
        box-shadow: 0 0 2px #e0b20e, 0 0 5px #e0b20e, 0 0 0px #e0b20e;
        transform: scale(1);
    }
}









/* Links de recuperação e criação de conta */
.links {
    margin-top:60px;
    margin-bottom: -30px;
    display: flex;
    justify-content: center;
    font-size: 14px;
    gap:140px;
   
    
}

.links a {
    color: #ffffff;
    text-decoration: none;
}

.links a:hover {
    text-decoration: underline;
}




 } 


    </style>




</head>
<body>
    <header class="header">
        <nav class="header_nav">
           <img src="../cartoes/logo2.png" alt="logo1" class="logo">
           <img src="../cartoes/Cadastr.png" alt="foto" class="ImgLo hidde">
            <button class="luzes-ligada" onclick="mudarParaClaro()">
                <i class="fa-solid fa-sun"></i>
            </button>
            <button class="luzes-apagada" onclick="mudarParaEscuro()" style="display: none;">
                <i class="fa-solid fa-moon"></i>
            </button>

        </nav>

    </header>

  
    <form class="container2" id="recuperarForm">
        <div id="notification-banner" class="hidden"></div>
    
        <h2 class="cad">Recuperar senha</h2>
    
        <div class="input-container">
            <input type="email" id="email" name="email" placeholder="Digite seu e-mail" required>
            <i class="fas fa-envelope"></i>
        </div>
        <button type="button" onclick="verificarEmail()" class="bthE"  id="btno">Verificar</button>
        <div id="redefinirCampos" style="display: none;">
            <div class="input-container">
                <input type="password" id="novaSenha" name="novaSenha" placeholder="Nova Senha" required>
                <i class="fas fa-lock"></i>
                <i class="fas fa-eye eye-icon" onclick="togglePassword()"></i>
            </div>
    
            <button type="button" onclick="salvarSenha()" class="bthE">Redefinir Senha</button>
        </div>
    
        
    
        <div class="links">
            <a href="../Login.html">Fazer Login!</a>
            <a href="../src/Cadastro.html">Criar Conta?</a>
        </div>
    </form>
    


    <script>
        document.addEventListener("DOMContentLoaded", function() {
    const Sol = document.querySelector('.luzes-ligada');  
    const Lua = document.querySelector('.luzes-apagada');  
    const Logo = document.querySelector('.logo');  
    const body = document.body; 

    function mudarParaClaro() {
        if (body.style.backgroundColor !== 'white') { // Evita repetição desnecessária
            body.style.backgroundColor = 'white';  
            body.style.color = 'black'; 
            Logo.src = "../cartoes/logo3.png"; // CORRIGIDO: Alterando a imagem corretamente
            Sol.style.display = 'none';  
            Lua.style.display = 'block'; 
        }
    }

    function mudarParaEscuro() {
        if (body.style.backgroundColor !== 'black') { // Evita repetição desnecessária
            body.style.backgroundColor = 'black';  
            body.style.color = 'white'; 
            Logo.src = "../cartoes/logo2.png"; // Retorna a imagem original
            Sol.style.display = 'block'; 
            Lua.style.display = 'none';  
        }
    }

    Sol.addEventListener("click", mudarParaClaro);
    Lua.addEventListener("click", mudarParaEscuro);
});


        function togglePassword() {
    const passwordInput = document.getElementById('novaSenha');
    const eyeIcon = document.querySelector('.eye-icon');

    // Verifica o tipo atual do campo de senha
    if (passwordInput.type === "password") {
        passwordInput.type = "text"; // Torna a senha visível
        eyeIcon.classList.replace("fa-eye", "fa-eye-slash"); // Muda o ícone para olho fechado
    } else {
        passwordInput.type = "password"; // Oculta a senha com ****
        eyeIcon.classList.replace("fa-eye-slash", "fa-eye"); // Muda o ícone para olho aberto
    }
}

function verificarEmail() {
    const email = document.getElementById('email').value;
    const usuarioId = localStorage.getItem('usuario_id'); // Obtém o ID do usuário do localStorage

    if (!usuarioId) {
        mostrarMensagem("Usuário não está logado!", "error");
        return;
    }

    fetch(`http://192.168.1.128:5000/verificarEmail/${usuarioId}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email })
    })
    .then(res => res.json())  // Tenta transformar a resposta em JSON
    .then(data => {
         // Exibe a resposta no console para depuração

        if (data.sucesso) {
            document.getElementById('btno').style.display = 'none';
            document.getElementById('redefinirCampos').style.display = 'block';
            
            
            mostrarMensagem('E-mail encontrado! Agora digite a nova senha.', 'success');
        } else {
            document.getElementById('btno').style.display = 'block';
            mostrarMensagem(data.message || data.error, 'error');

        }
    })
    .catch(err => {
        console.error("Erro na requisição:", err);
        mostrarMensagem('Erro ao verificar o e-mail.', 'error');
    });
}


function salvarSenha() {
    const novaSenha = document.getElementById("novaSenha").value;  // Pega o valor da nova senha
    const usuarioId = localStorage.getItem('usuario_id');  // Pega o ID do usuário no localStorage

    if (!usuarioId) {
        mostrarMensagem("Usuário não está logado!", "error");
        return;
    }

    fetch(`http://192.168.1.128:5000/atualizar-senha/${usuarioId}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ senha: novaSenha }),
    })
    .then(res => {
        if (!res.ok) throw new Error("Erro na resposta do servidor");
        return res.json();
    })
    .then(data => {
        
        if (data.sucesso) {
            // Exibir a senha no console
            mostrarMensagem("Senha Alterada com sucesso!!", "success");
            window.location.href = '../Login.html';

            
            // Redirecionar para a página de login após redefinir a senha
            
  // Substitua com o caminho correto para sua página de login
        } else {
            mostrarMensagem("Erro ao atualizar a senha.");
        }
    })
    .catch(erro => {
        console.error("Erro na requisição:", erro);
        mostrarMensagem("Ocorreu um erro ao tentar salvar.", "error");
    });

}


function mostrarMensagem(msg, tipo) {
    const banner = document.getElementById('notification-banner');
    banner.className = tipo === 'success' ? 'success' : 'error';
    banner.innerText = msg;
    banner.classList.remove('hidden');

    setTimeout(() => {
        banner.classList.add('hidden');
    }, 3000); // 3000ms = 3 segundos
}


    </script>
</body>
</html>